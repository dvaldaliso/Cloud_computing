// --------------------------------------------------------------------
// --------------------------------------------------------------------
// $    go mod tidy
// $    go build main.go       or      $   go run main.go

// --------------------------------------------------------------------
// --------------------------------------------------------------------
package main

// --------------------------------------------------------------------
// --------------------------------------------------------------------
import (
  "fmt"
  "context"

  kafka "github.com/segmentio/kafka-go"
)

// --------------------------------------------------------------------
// --------------------------------------------------------------------
func main() {
  fmt.Print( "productor empieza\n" )

  w := &kafka.Writer{
    Addr:  kafka.TCP("localhost:9092"),
    Topic: "topicazo1",
  }

  for i:=0; i<=10; i++ {
    texto := fmt.Sprintf( "Hello World! %d", i )
    fmt.Printf( "envio: %s\n", texto )
    w.WriteMessages(
      context.Background(),
      kafka.Message{
        Key:   []byte("Clave_A"),
        Value: []byte(texto),
      },
    )
  } // for

  w.Close()

} // ()

// --------------------------------------------------------------------
// --------------------------------------------------------------------
// --------------------------------------------------------------------
// --------------------------------------------------------------------
